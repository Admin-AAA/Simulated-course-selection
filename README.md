# 选课系统 (模拟)

本项目为一个简易的周末课程选课与课表可视化工具。支持：

- 课程搜索与筛选
- 选择/取消选择课程，统计已选学分、必修进度、GPA 学分、时间冲突数
- 周末(周六/周日)跨 18 周的日历栅格显示
- 选课导出 / 导入（JSON）
- 课表生成图片下载
- 课程按“最早开课周次 → 星期 → 开始时间”自动排序（新增）
 - 导出课表图片：时间单列 + 周六/周日两列，按周次在对应时间段垂直堆叠（新版布局）

## 课程排序说明（新增功能）

课程表中的 `<tbody>` 会在渲染时自动进行排序：

1. 解析 `weeks` 字段（如 `1-2,5-14周`、`11-18周`、`1,4-10周`）得到所有周次集合。
2. 取集合中的最小周次作为该课程的主排序键。
3. 然后按 `weekday`（数值：1=周一 ... 7=周日）升序。
4. 最后按 `startTime` 字符串升序（格式 `HH:mm`，可直接比较）。
5. 若课程没有可解析的周次，则视为“无周次信息”，被放到列表末尾。

对应实现见 `app.js` 中：

```js
function getEarliestWeek(course) { /* 解析最早周次 */ }
// renderCourseList 内对 state.filteredCourses 做 sort()
```

如果后续希望提供“切换排序方式（例如按课程代码/老师）”的交互，可以：

1. 在工具栏添加一个 `<select>` 或按钮组；
2. 将当前排序方式保存到 `state`；
3. 在 `renderCourseList()` 中根据 `state.sortMode` 选择不同的排序比较函数。

## 本地存储

选课、搜索关键词、当前周次等状态会持久化到浏览器 `localStorage`，刷新后自动恢复。

## 导入/导出

导出会包含：已选 ID 列表、课程详情快照、导出时间、学分统计。导入会自动过滤无效/重复课程代码记录。

## 课表图片
新版导出图片布局：

1. 仅展示周六、周日课程；
2. 左侧一列为三个时间段（上午 / 下午 / 晚上）；
3. 每个时间段对应一块纵向区域，在其中按出现的最小~最大周范围分层（“第X周”背景条）；
4. 同一周次、同一时间段、同一天可能出现多门课程时自动垂直平分该周块空间；
5. 颜色：普通(#dbeafe) / 必修(#fef3c7) / GPA(#d1fae5) / 冲突(同格多课,#fee2e2)；
6. 标注课程代码、名称（自动截断）、教师、教室、具体时间与所在周次。

---
欢迎继续提出需求或改进建议。
